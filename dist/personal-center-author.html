<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>个人中心-发布文章</title>
<link rel="stylesheet" href="http://static.runoob.com/assets/js/jquery-treeview/jquery.treeview.css" />
<link href="style/main.css" rel="stylesheet"><link href="style/main.css" rel="stylesheet"></head>

<body id="personal-center-public">

<h1 class="subtit mar_b10">当前位置：<span>个人中心</span> &gt;&gt; <em>作者申请</em></h1>
<div class="subcont">
	<div class="subcont_publish">
		<h3 class="g_tit_bor_red">
			<span>作者申请</span>
		</h3>
		<div class="subcont_publish_add">
			<div class="pb30 clearfix">
				<label class="fl">姓名：</label>
				<input class="fl" type="text" placeholder="请输入真实姓名" id="realName">
			</div>
			<div class="pb30 clearfix">
				<label class="fl">笔名：</label>
				<input class="fl" type="text" placeholder="请输入笔名" id="penName">
			</div>
			<div class="pb30 clearfix">
				<label class="fl">手机号：</label>
				<input class="fl" type="text" placeholder="请输入手机号" id="phone">
			</div>
			<div class="pb30 clearfix">
				<label class="fl">身份证号：</label>
				<input class="fl" type="text" placeholder="请输入身份证号" id="idNum">
			</div>
			<div class="pb30 clearfix" id="authorBtn">
				<label class="fl"></label>
				<a class="g_btn_white">重置</a>
				<a class="g_btn_red" style="margin-left: 30px;" onclick="applyAuthor()">提交申请</a>
			</div>
		</div>


	</div>
</div>

<script type="text/javascript" src="js/plugins/jquery.min.js"></script>
<script type="text/javascript" src="js/plugins/jquery.slide.js"></script>
<script type="text/javascript" src="js/plugins/jquery.treeview.js"></script>
<script type="text/javascript" src="js/plugins/jsrender.js"></script>
<script type="text/javascript" src="js/plugins/bundle.main.js"></script>
<script type="text/javascript" src="js/plugins/urlHandler.js"></script>
<script type="text/javascript" src="js/common/org.js"></script>
<script type="text/javascript" src="js/common/common.js"></script>

<script type="text/javascript">
    personal_center_login_vaild();
	$(function () {
		var author = getAuthor();
		if(author){
			$("#authorBtn").hide();
			$("#realName").val(author.realName);
			$("#penName").val(author.penName);
			$("#phone").val(author.phone);
			$("#idNum").val(author.idNum);
		}
	});
    /**
     * 申请开通作者权限
     */
    function applyAuthor(){
        var ticket = getTicket();
        if(!ticket){
            login();
        }else{
            var params = {};
            params.userCode = getUserCode();
            params.phone = $("#phone").val();
            params.idNum = $("#idNum").val();
            params.realName = $("#realName").val();
            params.penName = $("#penName").val();
            params.status = 0;
            var paramsJson = JSON.stringify(params);
            $.ajax({
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: paramsJson,
                url: url.mc.api_author,
                beforeSend: function(request) {
                    request.setRequestHeader("ticket", ticket);
                },
                success: function(response){
                    if(response && response.code == 200){
                        var author = response.data;
                        if(author){
                            var loginVo = getLoginVo();
                            loginVo.author = author;
                            localStorage.setItem("loginVo", loginVo);
                        }
                    }else{
                        alert(response.message);
                    }
                }
            });
        }
    }
</script>
</body>
</html>
